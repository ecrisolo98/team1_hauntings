<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Haunted Places Stress Radial Chart</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #111;
      color: #eee;
      text-align: center;
    }
    svg {
      background-color: #222;
      margin-top: 50px;
    }
    .legend {
      display: inline-block;
      width: 20px;
      height: 20px;
      margin-right: 10px;
    }
    .legend-container {
      text-align: left;
      margin: 20px;
    }
  </style>
</head>
<body>

<h1>Haunted Places vs State Stress</h1>

<svg id="radial" width="800" height="800"></svg>

<div class="legend-container">
  <h3>Legend: Stress Rank</h3>
  <div>
    <div class="legend" style="background-color: #f7a4a4;"></div> Low Stress
    <div class="legend" style="background-color: #d61e1e;"></div> High Stress
  </div>
</div>

<script>
// Load data from an external JSON file (ensure this JSON file is accessible)
d3.json("/team1_hauntings/data/haunted_places_stress.json").then(function(data) {

  // Sort the data by haunted_places in descending order and take the top 10 states
  const topStates = data.sort((a, b) => b.haunted_places - a.haunted_places).slice(0, 10);

  // Dimensions of the chart
  const width = 800;
  const height = 800;
  const radius = Math.min(width, height) / 2 - 50;  // Adjust the radius to match the new size
  const padding = 50;
  
  // Color scale for stress rank (e.g., lighter for lower stress, darker for higher stress)
  const colorScale = d3.scaleSequential(d3.interpolateReds)
    .domain([0, 50]); // Assuming stress rank goes from 0 (low stress) to 50 (high stress)

  // Size scale for the radius (mapping haunted places count to radius size)
  const radiusScale = d3.scaleLinear()
    .domain([0, d3.max(topStates, d => d.haunted_places)])
    .range([20, 100]); // Range for circle sizes (adjust the max size)

  // Create SVG element
  const svg = d3.select("#radial")
    .attr("width", width)
    .attr("height", height)
    .append("g")
    .attr("transform", `translate(${width / 2}, ${height / 2})`);

  // Create circles for each state
  const numStates = topStates.length;
  const angleStep = 2 * Math.PI / numStates;

  svg.selectAll("circle")
    .data(topStates)
    .enter().append("circle")
    .attr("cx", (d, i) => radius * Math.cos(i * angleStep))  // Position each circle in a circular pattern
    .attr("cy", (d, i) => radius * Math.sin(i * angleStep))
    .attr("r", d => radiusScale(d.haunted_places))  // Set circle size based on haunted places
    .attr("fill", d => colorScale(d.stress_rank))  // Set circle color based on stress rank
    .attr("stroke", "white")
    .attr("stroke-width", 2);

  // Add state names next to each circle
  svg.selectAll("text")
    .data(topStates)
    .enter().append("text")
    .attr("x", (d, i) => radius * Math.cos(i * angleStep))  // Position text to match circles
    .attr("y", (d, i) => radius * Math.sin(i * angleStep))
    .attr("dy", 5)  // Offset slightly from the circle
    .attr("text-anchor", "middle")
    .attr("fill", "white")
    .text(d => d.state);

}).catch(function(error) {
  console.error("Error loading the JSON data: ", error);
});

</script>

</body>
</html>

